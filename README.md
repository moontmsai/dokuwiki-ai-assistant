# DokuWiki AI Assistant Plugin

AI 기반 텍스트 편집 도우미 플러그인입니다. OpenAI API를 사용하여 선택한 텍스트를 개선하고 재구성합니다.

![DokuWiki Version](https://img.shields.io/badge/DokuWiki-2023--04--04%2B-blue)
![PHP Version](https://img.shields.io/badge/PHP-7.4%2B-green)
![License](https://img.shields.io/badge/License-MIT-yellow)

## 🚀 주요 기능

### ✨ 핵심 기능
- **스마트 텍스트 개선**: OpenAI GPT 모델을 활용한 텍스트 품질 향상
- **DokuWiki 문법 최적화**: 공식 문법에 맞는 자동 포맷팅
- **요청사항 기능**: `요청사항:내용` 형태로 맞춤 수정 요청
- **실시간 미리보기**: 원본과 개선된 텍스트 비교
- **컨텍스트 인식**: 앞뒤 문맥을 고려한 지능적 처리

### 🛠️ 사용자 경험
- **편집기 통합**: 툴바에 AI 버튼 자동 추가
- **키보드 단축키**: Ctrl+Alt+A 지원
- **다단계 검증**: 빈 텍스트 자동 차단
- **오류 처리**: 친화적인 오류 메시지 및 가이드
- **위치 제어**: 툴바 버튼 위치 설정 가능

## 📋 시스템 요구사항

- **DokuWiki**: 2023-04-04 "Jack Jackrum" 이상
- **PHP**: 7.4 이상
- **Extensions**: curl, json, mbstring
- **OpenAI API**: 유효한 API 키 필요
- **인터넷 연결**: API 호출을 위해 필요

## 📦 설치 방법

### 1. 다운로드 및 설치
```bash
# DokuWiki 플러그인 디렉토리로 이동
cd /path/to/dokuwiki/lib/plugins/

# 리포지토리 클론 (비공개 리포지토리의 경우)
git clone https://github.com/yourusername/dokuwiki-aiassist.git aiassist

# 또는 ZIP 파일 다운로드 후 압축 해제
unzip aiassist-main.zip
mv aiassist-main aiassist
```

### 2. 권한 설정
```bash
# 웹서버가 읽을 수 있도록 권한 설정
chown -R www-data:www-data aiassist/
chmod -R 755 aiassist/
```

### 3. AI 아이콘 준비
```bash
# images 디렉토리에 ai-icon.png 파일 필요 (16x16 픽셀)
# 포함된 ai-icon.svg를 PNG로 변환하거나 직접 제공
```

### 4. 플러그인 활성화
1. DokuWiki 관리자 페이지 접속
2. **확장 관리** → **확장 관리자** 이동
3. **AI Assistant** 플러그인 **활성화**

## ⚙️ 설정 방법

### 1. 기본 설정
관리자 페이지 → **설정 관리** → **AI Assistant** 섹션

#### 필수 설정
- **OpenAI API 키**: OpenAI에서 발급받은 API 키 입력

#### 권장 설정
- **OpenAI 모델**: 사용할 GPT 모델 선택
- **최대 토큰 수**: AI 응답의 최대 길이
- **온도**: AI 창의성 수준 (0-1)

### 2. 상세 설정 항목

| 설정 항목 | 기본값 | 범위 | 설명 |
|-----------|--------|------|------|
| **openai_api_key** | (없음) | - | OpenAI API 키 (필수) |
| **openai_model** | `gpt-4o` | 5가지 모델 | 사용할 GPT 모델 |
| **max_tokens** | `8000` | 100-120,000 | AI 응답 최대 토큰 수 |
| **temperature** | `0.3` | 0-1 | 창의성 수준 (낮을수록 일관성) |
| **toolbar_priority** | `9999` | 0-99999 | 툴바 버튼 위치 우선순위 |
| **context_length** | `500` | 100-2000 | 앞뒤 컨텍스트 길이 |

### 3. 모델별 특성

#### 🟢 추천 모델
- **GPT-4o Mini** (`gpt-4o-mini`): 경제적이면서 우수한 성능
- **GPT-4o** (`gpt-4o`): 최신 모델, 균형잡힌 성능

#### 📊 모델 비교
| 모델 | 최대 토큰 | 속도 | 비용 | 품질 | 추천 용도 |
|------|-----------|------|------|------|----------|
| `gpt-3.5-turbo` | 16K | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | 간단한 교정 |
| `gpt-4` | 8K | ⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | 정확한 분석 |
| `gpt-4-turbo` | 128K | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 긴 문서 |
| `gpt-4o` | 128K | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 범용 추천 |
| `gpt-4o-mini` | 128K | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 경제적 추천 |

## 🎯 사용 방법

### 1. 기본 사용법
1. **텍스트 선택**: 개선하고 싶은 텍스트를 드래그하여 선택
2. **AI 버튼 클릭**: 툴바의 AI 버튼 클릭 또는 `Ctrl+Alt+A` 사용
3. **미리보기 확인**: 원본과 개선된 텍스트 비교
4. **적용**: "변경사항 적용" 버튼으로 확정

### 2. 요청사항 기능 ✨ (신규!)
특별한 요청사항이 있을 때 사용하는 고급 기능

#### 📝 사용법
텍스트 끝에 `요청사항:내용` 형태로 추가:

```
프로젝트 진행 상황입니다.
1. 기획 단계 완료
2. 개발 진행중
3. 테스트 예정

요청사항: 더 전문적인 톤으로 변경하고 도쿠위키 목록 문법으로 수정해주세요
```

#### 🎯 결과
```
프로젝트 진행 현황은 다음과 같습니다.
  * 기획 단계 완료
  * 개발 진행 중
  * 테스트 예정
```

#### ⚡ 특징
- **요청사항 부분 자동 제거**: 최종 결과에서 "요청사항:" 부분 삭제
- **맞춤형 처리**: 일반 최적화가 아닌 특별한 요청 처리
- **DokuWiki 문법 보장**: 요청사항과 함께 문법도 최적화

### 3. 고급 활용 팁

#### 📋 DokuWiki 문법 자동 최적화
- **목록 변환**: `1. 항목` → `  * 항목`
- **들여쓰기 정리**: 일관성 있는 스페이싱
- **문법 보존**: 기존 `**굵게**`, `//기울임//` 등 유지

#### 🎨 다양한 요청사항 예시
```
요청사항: 더 친근한 톤으로 변경해주세요
요청사항: 기술적인 내용을 쉽게 설명해주세요
요청사항: 불필요한 내용을 제거하고 간결하게 만들어주세요
요청사항: 목록을 표 형태로 변경해주세요
```

## 🛡️ 보안 및 주의사항

### 🔒 보안
- **API 키 보호**: 설정에서 암호화하여 저장
- **입력 검증**: 다단계 텍스트 검증 시스템
- **오류 처리**: 안전한 오류 메시지 표시

### ⚠️ 주의사항
- **API 비용**: OpenAI API 사용 시 요금 발생
- **인터넷 필요**: 오프라인 환경에서 작동 불가
- **토큰 제한**: 모델별 최대 토큰 수 확인 필요
- **언어 지원**: 한국어 최적화 (다른 언어도 가능)

### 💰 비용 최적화 팁
- **짧은 텍스트**: 불필요하게 긴 텍스트 선택 지양
- **적절한 모델**: 용도에 맞는 모델 선택
- **컨텍스트 조정**: `context_length` 설정 최적화

## 🐛 문제 해결

### 자주 발생하는 문제

#### 1. "OpenAI API key not configured" 오류
```
해결방법: 관리자 페이지에서 올바른 API 키 설정
```

#### 2. "플러그인 저장소에 연결할 수 없습니다" 메시지
```
원인: DokuWiki 공식 저장소 연결 문제 (본 플러그인과 무관)
해결: 인터넷 연결 또는 무시 (로컬 설치된 플러그인은 정상 작동)
```

#### 3. AI 버튼이 보이지 않음
```
확인사항:
1. 플러그인 활성화 여부
2. 편집 모드에서 확인
3. 브라우저 캐시 삭제
4. JavaScript 오류 확인 (F12 개발자 도구)
```

#### 4. 응답이 너무 느림
```
최적화 방법:
1. 더 빠른 모델 사용 (gpt-3.5-turbo, gpt-4o-mini)
2. max_tokens 값 줄이기
3. context_length 값 줄이기
```

### 🔧 디버깅

#### 로그 확인
```bash
# DokuWiki 오류 로그 확인
tail -f /path/to/dokuwiki/data/cache/debug.log

# 웹서버 오류 로그 확인
tail -f /var/log/apache2/error.log  # Apache
tail -f /var/log/nginx/error.log    # Nginx
```

#### JavaScript 디버깅
```javascript
// 브라우저 콘솔에서 확인
console.log(window.AIASSIST_CONTEXT_LENGTH);
```

## 📁 파일 구조

```
aiassist/
├── README.md              # 이 파일
├── INSTALL.md             # 설치 상세 가이드
├── plugin.info.txt        # 플러그인 정보
├── action.php             # 메인 PHP 코드
├── script.js              # JavaScript 코드
├── style.css              # CSS 스타일
├── conf/
│   ├── default.php        # 기본 설정값
│   └── metadata.php       # 설정 메타데이터
├── lang/
│   └── ko/
│       └── settings.php   # 한국어 설정 레이블
├── images/
│   └── ai-icon.png        # AI 버튼 아이콘 (16x16)
└── ai-icon.svg            # SVG 원본 아이콘
```

## 🤝 기여하기

### 개발 환경 설정
1. DokuWiki 개발 환경 구축
2. 본 리포지토리 포크
3. 기능 브랜치 생성
4. 변경사항 커밋
5. 풀 리퀘스트 생성

### 코드 스타일
- **PHP**: PSR-12 표준 준수
- **JavaScript**: ES5 호환성 유지
- **주석**: 한국어/영어 혼용 가능

## 📜 라이선스

MIT License - 자세한 내용은 LICENSE 파일 참조

## 👨‍💻 개발자 정보

**작성자**: moontwt  
**이메일**: moontwt@example.com  
**깃허브**: [깃허브 링크]

## 🆕 버전 히스토리

### v1.2.0 (2024-12-20)
- ✨ 요청사항 기능 추가 (`요청사항:내용` 형태)
- 🎛️ 설정 가능한 컨텍스트 길이
- 📍 툴바 버튼 위치 제어 기능
- 🔧 향상된 오류 처리 및 검증

### v1.1.0 (2024-12-19)
- 🚀 다단계 텍스트 검증 시스템
- ⚡ 성능 최적화 및 안정성 향상
- 🎨 향상된 사용자 인터페이스

### v1.0.0 (2024-12-18)
- 🎉 첫 번째 안정 버전 출시
- 🤖 OpenAI API 통합
- 📝 DokuWiki 문법 최적화 기능

## 🙏 감사의 말

- **DokuWiki 커뮤니티**: 훌륭한 위키 엔진 제공
- **OpenAI**: 강력한 AI API 서비스
- **모든 사용자들**: 소중한 피드백과 제안

---

📧 **문의사항이나 버그 리포트**: [Issues 페이지](https://github.com/yourusername/dokuwiki-aiassist/issues)